<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/fragments/head :: head"></head>
<body class="hold-transition skin-blue sidebar-mini">
<!-- Site wrapper -->
<div class="wrapper">

    <div th:replace="admin/fragments/header :: header"></div>
    <!-- =============================================== -->

    <!-- Left side column. contains the sidebar -->
    <div th:replace="admin/fragments/sidebar :: sidebar"></div>

    <!-- =============================================== -->

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                Blank page
                <small>it all starts here</small>
            </h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
                <li><a href="#">Examples</a></li>
                <li class="active">Blank page</li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">

            <!-- Default box -->
            <div class="box">
                <div class="box-body">
                    <!-- add-product-modal.html -->
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content" style="border: 2px solid">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title" id="addProductModalLabel">Thêm Sản Phẩm Vào Hóa Đơn Chi
                                    Tiết</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                            </div>
                            <div class="modal-body">

                                <div class="mb-3">
                                    <form id="searchForm">
                                        <input type="hidden" name="hoaDonId" th:value="${hoaDon.id}">
                                        <input type="text" name="search" class="form-control me-2"
                                               placeholder="Tìm kiếm sản phẩm, màu sắc, kích thước..."
                                               th:value="${param.search}" aria-label="Search" id="searchInput"
                                               oninput="showSuggestions()">
                                    </form>
                                    <div id="suggestions" class="suggestions-list"></div> <!-- Hộp gợi ý -->
                                </div>

                                <!-- Danh sách sản phẩm -->
                                <form th:action="@{/add-product-order}" method="post">
                                    <input type="hidden" name="hoaDonId" th:value="${hoaDon.id}">
                                    <div class="product-list" style="border-top: 2px solid; padding-top: 20px;">
                                        <table class="table table-bordered table-striped align-middle">
                                            <thead class="text-center">
                                            <tr>
                                                <th>STT</th>
                                                <th>Sản Phẩm</th>
                                                <th>Số Lượng</th>
                                                <th>Thương Hiệu</th>
                                                <th>Xuất Sứ</th>
                                                <th>Trạng Thái</th>
                                                <th>Chọn</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:block th:each="sanPhamChiTiet, status : ${sanPhamChiTiet}">
                                                <td class="text-center" th:text="${status.index + 1}"></td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <img th:src="@{${'/images/'+sanPhamChiTiet.hinhAnh[0].urlHinhAnh}}"
                                                             style="width:80px; height: auto; object-fit: contain; border-radius: 8px;">
                                                        <div class="ms-3">
                                                            <strong th:text="${sanPhamChiTiet.sanPham.tenSanPham}"></strong>
                                                            (<span
                                                                th:text="${sanPhamChiTiet.mauSac.tenMauSac}"></span>
                                                            -
                                                            <span th:text="${sanPhamChiTiet.kichThuoc.tenKichThuoc}"></span>)<br>
                                                            <small class="text-danger font-weight-bold fs-5"
                                                                   th:text="${#numbers.formatInteger(sanPhamChiTiet.gia, 3, 'COMMA') + ' VND'}"></small><br>
                                                            <small class="text-muted"
                                                                   th:text="'Tồn Kho: ' + ${sanPhamChiTiet.soLuong}"></small>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="text-center">
                                                    <input type="number" name="soLuong" value="1" min="1"
                                                           th:max="${sanPhamChiTiet.soLuong}" class="form-control">
                                                </td>
                                                <td class="text-center"
                                                    th:text="${sanPhamChiTiet.sanPham.thuongHieu.tenThuongHieu}"></td>
                                                <td class="text-center"
                                                    th:text="${sanPhamChiTiet.sanPham.xuatXu.quocGia}"></td>
                                                <td class="text-center">
                                    <span th:class="${sanPhamChiTiet.trangThai == 'Đang Hoạt Động' ? 'badge bg-danger' : 'badge bg-success'}"
                                          th:text="${sanPhamChiTiet.trangThai}"></span>
                                                </td>
                                                <td class="text-center">
                                                    <button type="submit" name="sanPhamChiTietId"
                                                            th:value="${sanPhamChiTiet.id}"
                                                            class="btn btn-outline-primary">
                                                        Chọn
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.box -->

        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    <div th:replace="admin/fragments/footer :: footer"></div>


</div>
<!-- ./wrapper -->

<!-- jQuery 3 -->

<div th:replace="admin/fragments/script :: script"></div>

</body>
</html>
